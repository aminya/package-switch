"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const atom_space_pen_views_1 = require("atom-space-pen-views");
class BundleView extends atom_space_pen_views_1.SelectListView {
    initialize() {
        return super.initialize(...arguments);
    }
    viewForItem({ name, action }) {
        return atom_space_pen_views_1.$$(function () {
            return this.li(() => {
                return this.div({ class: `status-${action} icon icon-diff-${action}` }, name);
            });
        });
    }
    confirmed() {
        if (this.isDisabled()) {
            return this.setNeutral();
        }
        else if (this.isNeutral()) {
            return this.setEnabled();
        }
        else {
            return this.setDisabled();
        }
    }
    cancel() {
        const items = [];
        this.items.forEach(function (item) {
            if (item.action !== "ignored") {
                return items.push(item);
            }
        });
        super.cancel(...arguments);
        if (this.panel != null) {
            this.panel.hide();
        }
        if (items.length !== 0) {
            return this.cb(this.oldname, items);
        }
    }
    show(bundle = null, cb) {
        let actions;
        this.cb = cb;
        if (this.panel == null) {
            this.panel = atom.workspace.addModalPanel({ item: this });
        }
        this.panel.show();
        if (bundle != null) {
            this.oldname = bundle.name;
            actions = bundle.packages;
        }
        else {
            this.oldname = null;
            actions = [];
        }
        const packages = [];
        atom.packages.getAvailablePackageNames().forEach(function (name) {
            let action = actions.filter((item) => item.name === name);
            action = action[0] != null ? action[0].action : undefined;
            if (action == null) {
                action = "ignored";
            }
            return packages.push({ name, action });
        });
        this.setItems(packages);
        return this.focusFilterEditor();
    }
    populateList(view = null) {
        if (!view) {
            return super.populateList(...arguments);
        }
        const new_view = atom_space_pen_views_1.$(this.viewForItem(view.data("select-list-item")));
        new_view.data("select-list-item", view.data("select-list-item"));
        for (let index = 0; index < this.items.length; index++) {
            const item = this.items[index];
            if (item.name === view.data("select-list-item").name) {
                this.items[index].action = view.data("select-list-item").action;
                break;
            }
        }
        view.replaceWith(new_view);
        return this.selectItemView(new_view);
    }
    getFilterKey() {
        return "name";
    }
    isDisabled() {
        return this.getSelectedItemView().data("select-list-item").action === "removed";
    }
    isNeutral() {
        return this.getSelectedItemView().data("select-list-item").action === "ignored";
    }
    isEnabled() {
        return this.getSelectedItemView().data("select-list-item").action === "added";
    }
    setNeutral() {
        const view = this.getSelectedItemView();
        const data = view.data("select-list-item");
        data.action = "ignored";
        return this.populateList(view);
    }
    setEnabled() {
        const view = this.getSelectedItemView();
        const data = view.data("select-list-item");
        data.action = "added";
        return this.populateList(view);
    }
    setDisabled() {
        const view = this.getSelectedItemView();
        const data = view.data("select-list-item");
        data.action = "removed";
        return this.populateList(view);
    }
}
exports.BundleView = BundleView;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLXZpZXcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvYnVuZGxlLXZpZXcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFNQSwrREFBNEQ7QUFFNUQsTUFBYSxVQUFXLFNBQVEscUNBQWM7SUFDNUMsVUFBVTtRQUNSLE9BQU8sS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxDQUFBO0lBQ3ZDLENBQUM7SUFFRCxXQUFXLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFO1FBQzFCLE9BQU8seUJBQUUsQ0FBQztZQUNSLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUU7Z0JBQ2xCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxVQUFVLE1BQU0sbUJBQW1CLE1BQU0sRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUE7WUFDL0UsQ0FBQyxDQUFDLENBQUE7UUFDSixDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxTQUFTO1FBQ1AsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLEVBQUU7WUFDckIsT0FBTyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUE7U0FDekI7YUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUUsRUFBRTtZQUMzQixPQUFPLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQTtTQUN6QjthQUFNO1lBQ0wsT0FBTyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUE7U0FDMUI7SUFDSCxDQUFDO0lBRUQsTUFBTTtRQUNKLE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQTtRQUNoQixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLElBQUk7WUFDL0IsSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLFNBQVMsRUFBRTtnQkFDN0IsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO2FBQ3hCO1FBQ0gsQ0FBQyxDQUFDLENBQUE7UUFD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LE9BQU8sQ0FBQTtRQUNyQixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDaEMsQ0FBQztJQUVELFdBQVc7UUFDVCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQTtRQUN2QyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUE7UUFDMUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxTQUFTLENBQUE7UUFDdkIsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ2hDLENBQUM7Q0FDRjtBQTFIRCxnQ0EwSEMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogZGVjYWZmZWluYXRlIHN1Z2dlc3Rpb25zOlxuICogRFMxMDI6IFJlbW92ZSB1bm5lY2Vzc2FyeSBjb2RlIGNyZWF0ZWQgYmVjYXVzZSBvZiBpbXBsaWNpdCByZXR1cm5zXG4gKiBEUzIwNzogQ29uc2lkZXIgc2hvcnRlciB2YXJpYXRpb25zIG9mIG51bGwgY2hlY2tzXG4gKiBGdWxsIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9kZWNhZmZlaW5hdGUvZGVjYWZmZWluYXRlL2Jsb2IvbWFzdGVyL2RvY3Mvc3VnZ2VzdGlvbnMubWRcbiAqL1xuaW1wb3J0IHsgJCwgJCQsIFNlbGVjdExpc3RWaWV3IH0gZnJvbSBcImF0b20tc3BhY2UtcGVuLXZpZXdzXCJcblxuZXhwb3J0IGNsYXNzIEJ1bmRsZVZpZXcgZXh0ZW5kcyBTZWxlY3RMaXN0VmlldyB7XG4gIGluaXRpYWxpemUoKSB7XG4gICAgcmV0dXJuIHN1cGVyLmluaXRpYWxpemUoLi4uYXJndW1lbnRzKVxuICB9XG5cbiAgdmlld0Zvckl0ZW0oeyBuYW1lLCBhY3Rpb24gfSkge1xuICAgIHJldHVybiAkJChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5saSgoKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpdih7IGNsYXNzOiBgc3RhdHVzLSR7YWN0aW9ufSBpY29uIGljb24tZGlmZi0ke2FjdGlvbn1gIH0sIG5hbWUpXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBjb25maXJtZWQoKSB7XG4gICAgaWYgKHRoaXMuaXNEaXNhYmxlZCgpKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXROZXV0cmFsKClcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNOZXV0cmFsKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldEVuYWJsZWQoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXREaXNhYmxlZCgpXG4gICAgfVxuICB9XG5cbiAgY2FuY2VsKCkge1xuICAgIGNvbnN0IGl0ZW1zID0gW11cbiAgICB0aGlzLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmFjdGlvbiAhPT0gXCJpZ25vcmVkXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZW1zLnB1c2goaXRlbSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHN1cGVyLmNhbmNlbCguLi5hcmd1bWVudHMpXG4gICAgaWYgKHRoaXMucGFuZWwgIT0gbnVsbCkge1xuICAgICAgdGhpcy5wYW5lbC5oaWRlKClcbiAgICB9XG4gICAgaWYgKGl0ZW1zLmxlbmd0aCAhPT0gMCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2IodGhpcy5vbGRuYW1lLCBpdGVtcylcbiAgICB9XG4gIH1cblxuICBzaG93KGJ1bmRsZSA9IG51bGwsIGNiKSB7XG4gICAgbGV0IGFjdGlvbnNcbiAgICB0aGlzLmNiID0gY2JcbiAgICBpZiAodGhpcy5wYW5lbCA9PSBudWxsKSB7XG4gICAgICB0aGlzLnBhbmVsID0gYXRvbS53b3Jrc3BhY2UuYWRkTW9kYWxQYW5lbCh7IGl0ZW06IHRoaXMgfSlcbiAgICB9XG4gICAgdGhpcy5wYW5lbC5zaG93KClcblxuICAgIGlmIChidW5kbGUgIT0gbnVsbCkge1xuICAgICAgdGhpcy5vbGRuYW1lID0gYnVuZGxlLm5hbWVcbiAgICAgIGFjdGlvbnMgPSBidW5kbGUucGFja2FnZXNcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vbGRuYW1lID0gbnVsbFxuICAgICAgYWN0aW9ucyA9IFtdXG4gICAgfVxuXG4gICAgY29uc3QgcGFja2FnZXMgPSBbXVxuICAgIGF0b20ucGFja2FnZXMuZ2V0QXZhaWxhYmxlUGFja2FnZU5hbWVzKCkuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgbGV0IGFjdGlvbiA9IGFjdGlvbnMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLm5hbWUgPT09IG5hbWUpXG4gICAgICBhY3Rpb24gPSBhY3Rpb25bMF0gIT0gbnVsbCA/IGFjdGlvblswXS5hY3Rpb24gOiB1bmRlZmluZWRcbiAgICAgIGlmIChhY3Rpb24gPT0gbnVsbCkge1xuICAgICAgICBhY3Rpb24gPSBcImlnbm9yZWRcIlxuICAgICAgfVxuICAgICAgcmV0dXJuIHBhY2thZ2VzLnB1c2goeyBuYW1lLCBhY3Rpb24gfSlcbiAgICB9KVxuXG4gICAgdGhpcy5zZXRJdGVtcyhwYWNrYWdlcylcbiAgICByZXR1cm4gdGhpcy5mb2N1c0ZpbHRlckVkaXRvcigpXG4gIH1cblxuICBwb3B1bGF0ZUxpc3QodmlldyA9IG51bGwpIHtcbiAgICBpZiAoIXZpZXcpIHtcbiAgICAgIHJldHVybiBzdXBlci5wb3B1bGF0ZUxpc3QoLi4uYXJndW1lbnRzKVxuICAgIH1cbiAgICBjb25zdCBuZXdfdmlldyA9ICQodGhpcy52aWV3Rm9ySXRlbSh2aWV3LmRhdGEoXCJzZWxlY3QtbGlzdC1pdGVtXCIpKSlcbiAgICBuZXdfdmlldy5kYXRhKFwic2VsZWN0LWxpc3QtaXRlbVwiLCB2aWV3LmRhdGEoXCJzZWxlY3QtbGlzdC1pdGVtXCIpKVxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLml0ZW1zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXNbaW5kZXhdXG4gICAgICBpZiAoaXRlbS5uYW1lID09PSB2aWV3LmRhdGEoXCJzZWxlY3QtbGlzdC1pdGVtXCIpLm5hbWUpIHtcbiAgICAgICAgdGhpcy5pdGVtc1tpbmRleF0uYWN0aW9uID0gdmlldy5kYXRhKFwic2VsZWN0LWxpc3QtaXRlbVwiKS5hY3Rpb25cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gICAgdmlldy5yZXBsYWNlV2l0aChuZXdfdmlldylcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RJdGVtVmlldyhuZXdfdmlldylcbiAgfVxuXG4gIGdldEZpbHRlcktleSgpIHtcbiAgICByZXR1cm4gXCJuYW1lXCJcbiAgfVxuXG4gIGlzRGlzYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U2VsZWN0ZWRJdGVtVmlldygpLmRhdGEoXCJzZWxlY3QtbGlzdC1pdGVtXCIpLmFjdGlvbiA9PT0gXCJyZW1vdmVkXCJcbiAgfVxuXG4gIGlzTmV1dHJhbCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZWxlY3RlZEl0ZW1WaWV3KCkuZGF0YShcInNlbGVjdC1saXN0LWl0ZW1cIikuYWN0aW9uID09PSBcImlnbm9yZWRcIlxuICB9XG5cbiAgaXNFbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGVkSXRlbVZpZXcoKS5kYXRhKFwic2VsZWN0LWxpc3QtaXRlbVwiKS5hY3Rpb24gPT09IFwiYWRkZWRcIlxuICB9XG5cbiAgc2V0TmV1dHJhbCgpIHtcbiAgICBjb25zdCB2aWV3ID0gdGhpcy5nZXRTZWxlY3RlZEl0ZW1WaWV3KClcbiAgICBjb25zdCBkYXRhID0gdmlldy5kYXRhKFwic2VsZWN0LWxpc3QtaXRlbVwiKVxuICAgIGRhdGEuYWN0aW9uID0gXCJpZ25vcmVkXCJcbiAgICByZXR1cm4gdGhpcy5wb3B1bGF0ZUxpc3QodmlldylcbiAgfVxuXG4gIHNldEVuYWJsZWQoKSB7XG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtVmlldygpXG4gICAgY29uc3QgZGF0YSA9IHZpZXcuZGF0YShcInNlbGVjdC1saXN0LWl0ZW1cIilcbiAgICBkYXRhLmFjdGlvbiA9IFwiYWRkZWRcIlxuICAgIHJldHVybiB0aGlzLnBvcHVsYXRlTGlzdCh2aWV3KVxuICB9XG5cbiAgc2V0RGlzYWJsZWQoKSB7XG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtVmlldygpXG4gICAgY29uc3QgZGF0YSA9IHZpZXcuZGF0YShcInNlbGVjdC1saXN0LWl0ZW1cIilcbiAgICBkYXRhLmFjdGlvbiA9IFwicmVtb3ZlZFwiXG4gICAgcmV0dXJuIHRoaXMucG9wdWxhdGVMaXN0KHZpZXcpXG4gIH1cbn1cbiJdfQ==